!function(){let e={};function t(t,r){return void 0===e[t]&&(e[t]=[]),e[t]=[...e[t],r],function(){e[t]=e[t].filter((e=>e!==r))}}customElements.get("recipient-form")||customElements.define("recipient-form",class extends HTMLElement{constructor(){var e,t,r;super(),this.checkboxInput=this.querySelector(`#Recipient-checkbox-${this.dataset.sectionId}`),this.checkboxInput.disabled=!1,this.hiddenControlField=this.querySelector(`#Recipient-control-${this.dataset.sectionId}`),this.hiddenControlField.disabled=!0,this.emailInput=this.querySelector(`#Recipient-email-${this.dataset.sectionId}`),this.nameInput=this.querySelector(`#Recipient-name-${this.dataset.sectionId}`),this.messageInput=this.querySelector(`#Recipient-message-${this.dataset.sectionId}`),this.sendonInput=this.querySelector(`#Recipient-send-on-${this.dataset.sectionId}`),this.offsetProperty=this.querySelector(`#Recipient-timezone-offset-${this.dataset.sectionId}`),this.offsetProperty&&(this.offsetProperty.value=(new Date).getTimezoneOffset().toString()),this.errorMessageWrapper=this.querySelector(".product-form__recipient-error-message-wrapper"),this.errorMessageList=null===(e=this.errorMessageWrapper)||void 0===e?void 0:e.querySelector("ul"),this.errorMessage=null===(t=this.errorMessageWrapper)||void 0===t?void 0:t.querySelector(".error-message"),this.defaultErrorHeader=null===(r=this.errorMessage)||void 0===r?void 0:r.innerText,this.currentProductVariantId=this.dataset.productVariantId,this.addEventListener("change",this.onChange.bind(this)),this.onChange()}cartUpdateUnsubscriber=void 0;variantChangeUnsubscriber=void 0;cartErrorUnsubscriber=void 0;connectedCallback(){this.cartUpdateUnsubscriber=t("cart-update",(e=>{"product-form"===e.source&&e.productVariantId.toString()===this.currentProductVariantId&&this.resetRecipientForm()})),this.variantChangeUnsubscriber=t("variant-change",(e=>{e.data.sectionId===this.dataset.sectionId&&(this.currentProductVariantId=e.data.variant.id.toString())})),this.cartUpdateUnsubscriber=t("cart-error",(e=>{"product-form"===e.source&&e.productVariantId.toString()===this.currentProductVariantId&&this.displayErrorMessage(e.message,e.errors)}))}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber(),this.variantChangeUnsubscriber&&this.variantChangeUnsubscriber(),this.cartErrorUnsubscriber&&this.cartErrorUnsubscriber()}onChange(){this.checkboxInput.checked?this.enableInputFields():(this.clearInputFields(),this.disableInputFields(),this.clearErrorMessage())}inputFields(){return[this.emailInput,this.nameInput,this.messageInput,this.sendonInput]}disableableFields(){return[...this.inputFields(),this.offsetProperty]}clearInputFields(){this.inputFields().forEach((e=>e.value=""))}enableInputFields(){this.disableableFields().forEach((e=>e.disabled=!1))}disableInputFields(){this.disableableFields().forEach((e=>e.disabled=!0))}displayErrorMessage(e,t){if(this.clearErrorMessage(),this.errorMessageWrapper.hidden=!1,"object"==typeof t)return this.errorMessage.innerText=this.defaultErrorHeader,Object.entries(t).forEach((e=>{let[t,r]=e;const s=`RecipientForm-${t}-error-${this.dataset.sectionId}`,i=`#Recipient-${t}-${this.dataset.sectionId}`,a=`${r.join(", ")}`,n=this.querySelector(`#${s}`),o=null==n?void 0:n.querySelector(".error-message");if(!o)return;this.errorMessageList&&this.errorMessageList.appendChild(this.createErrorListItem(i,a)),o.innerText=`${a}.`,n.classList.remove("u-hide");const c=this[`${t}Input`];c&&(c.setAttribute("aria-invalid",!0),c.setAttribute("aria-describedby",s))}));this.errorMessage.innerText=t}createErrorListItem(e,t){const r=document.createElement("li"),s=document.createElement("a");return s.setAttribute("href",e),s.innerText=t,r.appendChild(s),r.className="error-message",r}clearErrorMessage(){this.errorMessageWrapper.hidden=!0,this.errorMessageList&&(this.errorMessageList.innerHTML=""),this.querySelectorAll(".recipient-fields .form__message").forEach((e=>{e.classList.add("u-hide");const t=e.querySelector(".error-message");t&&(t.innerText="")})),[this.emailInput,this.messageInput,this.nameInput,this.sendonInput].forEach((e=>{e.setAttribute("aria-invalid",!1),e.removeAttribute("aria-describedby")}))}resetRecipientForm(){this.checkboxInput.checked&&(this.checkboxInput.checked=!1,this.clearInputFields(),this.clearErrorMessage())}})}();